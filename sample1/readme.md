

# GP tools for AWS Sample 2

This sample uses AWS EMR to generate a map based on web log analysis results. 

The log data samples included in this example are extracted from ArcGIS Online logs, for simplicity they have been cleaned and formated in a csv file. Hadoop is recommended for analysis of very large log files, and to get optimal performance it's recommended that you partition your data. The sample includes, the directory strucutre for data, and the script includes the hive command to apply partitioning.  

Results generated by the hive script are visualized in [ArcGIS Desktop](http://www.esri.com/software/arcgis/arcgis-for-desktop) to generate the map. Here's an example of a map visualized in ArcGIS Desktop after getting the results from EMR.

<img src="sample1map.png" alt="map-img"  width="520"> 

## Instrcutions

* Download the sample 

* Upload the data sample to a known location in your S3, follow the same exact directory structure and directory naming (for example dt=0).

* Update the hive script to point to where your data is in S3, then upload it to S3 as well.

* Execute the hive script using the Run Hive Query tool. Point to a new directory in S3 for output, make sure the directory where you will write the output doesn't already exist. 

* After the query finishes, check the output location to download your results. The result should include 1331 records, here's a sample of what the first five records look like:
 
2797	2134	4884	4	3857318	9595599	   
3939	2389	4788	8	3387689	8348146	   
8470	2391	4786	8	3377905	8338363	   
9259	2391	4787	4	3382797	8338363	   
2368	2438	5224	44	5520588	8108440	 

* Add this data as a layer in ArcGIS Desktop. Right click on the layer and choose Display XY Data. Set the last two fields for your X and Y, these are the fields that represent the points for visualization. Also click edit the coordinate system, search for "web mercator", and choose that as the data proejction. 

* After your result is added to the map, you can add a base map to give it context.

* Also, for better visualiztion, right click on the layer you added with your data, choose properties and select the symbology tab. You have many choices for symbolgy options, to get the same one in the map above, select Quantities: Graduated Symbols, then select Field 4 for values.


## Requirements

* Setup GP Tools for AWS first

## Issues

Find a bug or want to request a new feature?  Please let us know by submitting an issue.

## Contributing

Esri welcomes contributions from anyone and everyone. Please see our [guidelines for contributing](https://github.com/esri/contributing).

